```{r}
#| label: setup
#| include: false

source(here::here("R", "_setup.R"))
```

<!-- badges: start -->
[![License: MIT](https://img.shields.io/badge/License-MIT-green.svg)](https://opensource.org/licenses/MIT)
[![License: CC BY 4.0](https://img.shields.io/badge/License-CC_BY_4.0-lightgrey.svg)](https://creativecommons.org/licenses/by/4.0/)
<!-- badges: end -->

## Overview

This report presents the implementation of the *Business Investor Model* described in @railsback2019a. The model simulates interactions between businesses and investors to demonstrate fundamental concepts in agent-based modeling.

## Model 10.4.2

## Setting the Environment

```{r}
#| eval: false
#| output: false

library(brandr)
library(dplyr)
library(ggplot2)
library(here)
library(janitor)
library(readr)
library(stats)
```

### Figure 10.1.1

```{r}
data <-
  here::here(
    "data",
    "business-investor-model-10-4-2-figure-10-1-1-table.csv"
  ) |>
  readr::read_csv(
    skip = 6,
    col_types = readr::cols(.default = "c")
  ) |>
  janitor::clean_names() |>
  dplyr::select(
    run_number,
    sensing_radius,
    mean_wealth_of_investors,
    standard_deviation_wealth_of_investors
  ) |>
  dplyr::mutate(
    dplyr::across(
      .cols = dplyr::everything(),
      .fns = as.numeric
    )
  ) |>
  dplyr::summarize(
    mean = mean(mean_wealth_of_investors, na.rm = TRUE),
    sd = mean(standard_deviation_wealth_of_investors, na.rm = TRUE),
    .by = sensing_radius
  )
```

```{r}
data
```

```{r}
#| eval: false
#| include: false

data |> dplyr::glimpse()
```

```{r}
data |>
  ggplot2::ggplot() +
  ggplot2::geom_point(
    mapping = ggplot2::aes(x = sensing_radius, y = mean),
    shape = 19,
  ) +
  ggplot2::geom_point(
    mapping = ggplot2::aes(x = sensing_radius, y = sd),
    shape = 8,
  ) +
  ggplot2::scale_x_continuous(breaks = seq(0, 10, 2)) +
  ggplot2::scale_y_continuous(
    breaks = seq(0, 600000, 100000),
    labels = ~ prettyNum(.x, big.mark = ",")
  ) +
  ggplot2::labs(
    x = "Sensing radius",
    y = "Mean final investor wealth"
  )
```

### Figure 10.1.2

```{r}
data <-
  here::here(
    "data",
    "business-investor-model-10-4-2-figure-10-1-2-table.csv"
  ) |>
  readr::read_csv(
    skip = 6,
    col_types = readr::cols(.default = "c")
  ) |>
  janitor::clean_names() |>
  dplyr::select(
    run_number,
    step,
    sensing_radius,
    mean_wealth_of_investors
  ) |>
  dplyr::mutate(
    dplyr::across(
      .cols = dplyr::everything(),
      .fns = as.numeric
    )
  ) |>
  dplyr::mutate(
    sensing_radius = factor(sensing_radius, ordered = TRUE)
  ) |>

  dplyr::summarize(
    mean = mean(mean_wealth_of_investors, na.rm = TRUE),
    .by = c("step", "sensing_radius")
  )
```

```{r}
data
```

```{r}
#| eval: false
#| include: false

data |> dplyr::glimpse()
```

```{r}
data |>
  ggplot2::ggplot(ggplot2::aes(x = step, y = mean, color = sensing_radius)) +
  ggplot2::geom_line() +
  ggplot2::scale_x_continuous(breaks = seq(0, 50, 10)) +
  ggplot2::scale_y_continuous(
    breaks = seq(0, 700000, 100000),
    labels = ~ prettyNum(.x, big.mark = ",")
  ) +
  ggplot2::labs(
    x = "Year",
    y = "Mean investor wealth",
    color = "Sensing radius"
  ) +
  brandr::scale_color_brand_d()
```

## License

::: {style="text-align: left;"}
[![](https://img.shields.io/badge/License-CC0_1.0-lightgrey.svg)](http://creativecommons.org/publicdomain/zero/1.0/)
:::

This report is licensed under [CC0 1.0 Universal](https://creativecommons.org/publicdomain/zero/1.0/), placing it in the public domain. You may freely copy, modify, distribute, and use this work, even for commercial purposes, without permission or attribution.

## References {.unnumbered}

::: {#refs}
:::
