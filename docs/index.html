<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="dcterms.date" content="2025-04-22">
<title>Business Investor Model</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<link href="./images/favicon.svg" rel="icon" type="image/svg+xml">
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2ade4c202a29add217eadf66f1be2696.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-16aebcbcd2d1562a7b9b0023879e2ecd.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<meta property="og:title" content="Business Investor Model">
<meta property="og:description" content="">
<meta property="og:image" content="https://danielvartan.github.io/business-investor-model/images/og-image.png">
<meta property="og:image:alt" content="Sustentarea Research and Extension Group">
<meta property="og:image:height" content="1600">
<meta property="og:image:width" content="2400">
<meta name="citation_title" content="Business Investor Model">
<meta name="citation_publication_date" content="2025-04-22">
<meta name="citation_cover_date" content="2025-04-22">
<meta name="citation_year" content="2025">
<meta name="citation_online_date" content="2025-04-22">
<meta name="citation_fulltext_html_url" content="https://danielvartan.github.io/business-investor-model/">
<meta name="citation_language" content="en">
<meta name="citation_reference" content="citation_title=Agent-based and individual-based modeling: A practical introduction;,citation_author=Steven F. Railsback;,citation_author=Volker Grimm;,citation_publication_date=2019;,citation_cover_date=2019;,citation_year=2019;,citation_isbn=978-0-691-19082-2;,citation_language=en-US;">
</head>
<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item compact">
    <a class="nav-link" href="https://github.com/danielvartan/business-investor-model"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a></li>
  <li>
<a href="#model-10.4.2" id="toc-model-10.4.2" class="nav-link" data-scroll-target="#model-10.4.2">Model 10.4.2</a>
  <ul>
<li><a href="#setting-the-environment" id="toc-setting-the-environment" class="nav-link" data-scroll-target="#setting-the-environment">Setting the Environment</a></li>
  <li><a href="#figure-10.1.1" id="toc-figure-10.1.1" class="nav-link" data-scroll-target="#figure-10.1.1">Figure 10.1.1</a></li>
  <li><a href="#figure-10.1.2" id="toc-figure-10.1.2" class="nav-link" data-scroll-target="#figure-10.1.2">Figure 10.1.2</a></li>
  </ul>
</li>
  <li>
<a href="#model-11.5" id="toc-model-11.5" class="nav-link" data-scroll-target="#model-11.5">Model 11.5</a>
  <ul>
<li><a href="#figure-12.1" id="toc-figure-12.1" class="nav-link" data-scroll-target="#figure-12.1">Figure 12.1</a></li>
  <li><a href="#figure-12.2" id="toc-figure-12.2" class="nav-link" data-scroll-target="#figure-12.2">Figure 12.2</a></li>
  </ul>
</li>
  <li><a href="#license" id="toc-license" class="nav-link" data-scroll-target="#license">License</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/danielvartan/business-investor-model/edit/main/index.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/danielvartan/business-investor-model/blob/main/index.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li><li><a href="https://github.com/danielvartan/business-investor-model/issues/" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">Business Investor Model</h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">2025-04-22</p>
    </div>
  </div>
  
    
  </div>
  


</header><!-- badges: start --><p><a href="http://creativecommons.org/publicdomain/zero/1.0/"><img src="https://img.shields.io/badge/License-CC0_1.0-lightgrey.svg" class="img-fluid"></a> <!-- badges: end --></p>
<section id="overview" class="level2"><h2 class="anchored" data-anchor-id="overview">Overview</h2>
<p>This report presents analyses and visualizations of the <em>Business Investor Model</em> described in <span class="citation" data-cites="railsback2019a">Railsback &amp; Grimm (<a href="#ref-railsback2019a" role="doc-biblioref">2019</a>)</span>. The model simulates interactions between businesses and investors to demonstrate fundamental concepts in agent-based modeling (ABM).</p>
</section><section id="model-10.4.2" class="level2"><h2 class="anchored" data-anchor-id="model-10.4.2">Model 10.4.2</h2>
<section id="setting-the-environment" class="level3"><h3 class="anchored" data-anchor-id="setting-the-environment">Setting the Environment</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://danielvartan.github.io/brandr/">brandr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/">here</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sfirke/janitor">janitor</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org">readr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">stats</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="figure-10.1.1" class="level3"><h3 class="anchored" data-anchor-id="figure-10.1.1">Figure 10.1.1</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span></span>
<span>    <span class="st">"data"</span>,</span>
<span>    <span class="st">"business-investor-model-10-4-2-figure-10-1-1-table.csv"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span></span>
<span>    skip <span class="op">=</span> <span class="fl">6</span>,</span>
<span>    col_types <span class="op">=</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/cols.html">cols</a></span><span class="op">(</span>.default <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/clean_names.html">clean_names</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span></span>
<span>    <span class="va">run_number</span>,</span>
<span>    <span class="va">sensing_radius</span>,</span>
<span>    <span class="va">mean_wealth_of_investors</span>,</span>
<span>    <span class="va">standard_deviation_wealth_of_investors</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span></span>
<span>      .cols <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      .fns <span class="op">=</span> <span class="va">as.numeric</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span></span>
<span>    mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">mean_wealth_of_investors</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">standard_deviation_wealth_of_investors</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    .by <span class="op">=</span> <span class="va">sensing_radius</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["sensing_radius"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["mean"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["sd"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"0","2":"49743.84012","3":"129150.3963"},{"1":"1","2":"316005.70097","3":"249570.2586"},{"1":"2","2":"417121.49891","3":"287218.4439"},{"1":"3","2":"571272.08312","3":"371470.5544"},{"1":"4","2":"574094.04189","3":"338223.0350"},{"1":"5","2":"545943.13647","3":"321732.2046"},{"1":"6","2":"653742.75088","3":"384329.7551"},{"1":"7","2":"644960.08901","3":"372539.4408"},{"1":"8","2":"643108.21598","3":"374664.8839"},{"1":"9","2":"666928.85192","3":"424440.1488"},{"1":"10","2":"702894.33050","3":"386994.0417"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">sensing_radius</span>, y <span class="op">=</span> <span class="va">mean</span><span class="op">)</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    shape <span class="op">=</span> <span class="fl">19</span>,</span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">sensing_radius</span>, y <span class="op">=</span> <span class="va">sd</span><span class="op">)</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    shape <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">700000</span>, <span class="fl">100000</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/formatc.html">prettyNum</a></span><span class="op">(</span><span class="va">.x</span>, big.mark <span class="op">=</span> <span class="st">","</span><span class="op">)</span>,</span>
<span>    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">700000</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Sensing radius"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Mean final investor wealth"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 1 row containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_point()`).</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="index_files/figure-html/unnamed-chunk-6-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="figure-10.1.2" class="level3"><h3 class="anchored" data-anchor-id="figure-10.1.2">Figure 10.1.2</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span></span>
<span>    <span class="st">"data"</span>,</span>
<span>    <span class="st">"business-investor-model-10-4-2-figure-10-1-2-table.csv"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span></span>
<span>    skip <span class="op">=</span> <span class="fl">6</span>,</span>
<span>    col_types <span class="op">=</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/cols.html">cols</a></span><span class="op">(</span>.default <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/clean_names.html">clean_names</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span></span>
<span>    <span class="va">run_number</span>,</span>
<span>    <span class="va">step</span>,</span>
<span>    <span class="va">sensing_radius</span>,</span>
<span>    <span class="va">mean_wealth_of_investors</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span></span>
<span>      .cols <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      .fns <span class="op">=</span> <span class="va">as.numeric</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    sensing_radius <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">sensing_radius</span>, ordered <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span></span>
<span>    mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">mean_wealth_of_investors</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    .by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"step"</span>, <span class="st">"sensing_radius"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["step"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["sensing_radius"],"name":[2],"type":["ord"],"align":["right"]},{"label":["mean"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"0","2":"0","3":"0.000000"},{"1":"1","2":"0","3":"5160.194726"},{"1":"2","2":"0","3":"9739.028228"},{"1":"3","2":"0","3":"13889.341082"},{"1":"4","2":"0","3":"17253.482539"},{"1":"5","2":"0","3":"20080.871059"},{"1":"6","2":"0","3":"23987.928291"},{"1":"7","2":"0","3":"26895.682844"},{"1":"8","2":"0","3":"30115.757393"},{"1":"9","2":"0","3":"32885.196028"},{"1":"10","2":"0","3":"33919.742252"},{"1":"11","2":"0","3":"35496.499309"},{"1":"12","2":"0","3":"38228.178209"},{"1":"13","2":"0","3":"40038.506768"},{"1":"14","2":"0","3":"40416.608737"},{"1":"15","2":"0","3":"42488.829184"},{"1":"16","2":"0","3":"43755.509551"},{"1":"17","2":"0","3":"45559.784292"},{"1":"18","2":"0","3":"46690.526465"},{"1":"19","2":"0","3":"46499.680054"},{"1":"20","2":"0","3":"46260.211608"},{"1":"21","2":"0","3":"48257.958211"},{"1":"22","2":"0","3":"49207.535434"},{"1":"23","2":"0","3":"48452.212582"},{"1":"24","2":"0","3":"50178.639960"},{"1":"25","2":"0","3":"50367.235715"},{"1":"26","2":"0","3":"52066.042151"},{"1":"27","2":"0","3":"53692.167528"},{"1":"28","2":"0","3":"51789.817121"},{"1":"29","2":"0","3":"53639.453447"},{"1":"30","2":"0","3":"55489.089772"},{"1":"31","2":"0","3":"52602.622876"},{"1":"32","2":"0","3":"52759.738029"},{"1":"33","2":"0","3":"49134.397912"},{"1":"34","2":"0","3":"49420.699712"},{"1":"35","2":"0","3":"50070.650143"},{"1":"36","2":"0","3":"46499.027742"},{"1":"37","2":"0","3":"43024.092963"},{"1":"38","2":"0","3":"39146.733427"},{"1":"39","2":"0","3":"38299.292514"},{"1":"40","2":"0","3":"39281.325655"},{"1":"41","2":"0","3":"38293.176210"},{"1":"42","2":"0","3":"35474.722583"},{"1":"43","2":"0","3":"36187.229856"},{"1":"44","2":"0","3":"32603.591612"},{"1":"45","2":"0","3":"31439.257073"},{"1":"46","2":"0","3":"32137.907230"},{"1":"47","2":"0","3":"31411.748741"},{"1":"48","2":"0","3":"32080.083821"},{"1":"49","2":"0","3":"32633.532057"},{"1":"50","2":"0","3":"33071.533102"},{"1":"0","2":"1","3":"0.000000"},{"1":"1","2":"1","3":"10653.440527"},{"1":"2","2":"1","3":"22145.631085"},{"1":"3","2":"1","3":"33040.513117"},{"1":"4","2":"1","3":"43957.166326"},{"1":"5","2":"1","3":"54877.106419"},{"1":"6","2":"1","3":"64305.949556"},{"1":"7","2":"1","3":"73580.767804"},{"1":"8","2":"1","3":"82454.470087"},{"1":"9","2":"1","3":"92428.832554"},{"1":"10","2":"1","3":"101410.250251"},{"1":"11","2":"1","3":"110293.498382"},{"1":"12","2":"1","3":"119276.866737"},{"1":"13","2":"1","3":"129084.698603"},{"1":"14","2":"1","3":"134974.963394"},{"1":"15","2":"1","3":"144412.996609"},{"1":"16","2":"1","3":"151043.305626"},{"1":"17","2":"1","3":"155398.279825"},{"1":"18","2":"1","3":"161954.566381"},{"1":"19","2":"1","3":"170495.348831"},{"1":"20","2":"1","3":"178355.208034"},{"1":"21","2":"1","3":"187013.370638"},{"1":"22","2":"1","3":"193154.683441"},{"1":"23","2":"1","3":"200521.419807"},{"1":"24","2":"1","3":"206147.860725"},{"1":"25","2":"1","3":"210218.020106"},{"1":"26","2":"1","3":"218009.631196"},{"1":"27","2":"1","3":"225109.649578"},{"1":"28","2":"1","3":"232210.607025"},{"1":"29","2":"1","3":"240684.884742"},{"1":"30","2":"1","3":"242717.842535"},{"1":"31","2":"1","3":"245762.787465"},{"1":"32","2":"1","3":"253723.039699"},{"1":"33","2":"1","3":"253843.461057"},{"1":"34","2":"1","3":"259313.181105"},{"1":"35","2":"1","3":"265865.156933"},{"1":"36","2":"1","3":"271460.106021"},{"1":"37","2":"1","3":"271710.670515"},{"1":"38","2":"1","3":"277017.804536"},{"1":"39","2":"1","3":"279870.866177"},{"1":"40","2":"1","3":"285424.644838"},{"1":"41","2":"1","3":"291928.518318"},{"1":"42","2":"1","3":"294290.777060"},{"1":"43","2":"1","3":"301147.349480"},{"1":"44","2":"1","3":"307649.407867"},{"1":"45","2":"1","3":"313674.941878"},{"1":"46","2":"1","3":"321660.957993"},{"1":"47","2":"1","3":"328014.547833"},{"1":"48","2":"1","3":"333888.128357"},{"1":"49","2":"1","3":"330788.214224"},{"1":"50","2":"1","3":"335714.894153"},{"1":"0","2":"2","3":"0.000000"},{"1":"1","2":"2","3":"14030.316919"},{"1":"2","2":"2","3":"28987.190916"},{"1":"3","2":"2","3":"42788.506190"},{"1":"4","2":"2","3":"57558.361949"},{"1":"5","2":"2","3":"71255.216105"},{"1":"6","2":"2","3":"82669.691938"},{"1":"7","2":"2","3":"94383.889817"},{"1":"8","2":"2","3":"105672.873114"},{"1":"9","2":"2","3":"118722.038949"},{"1":"10","2":"2","3":"130344.291323"},{"1":"11","2":"2","3":"142238.527134"},{"1":"12","2":"2","3":"150005.616483"},{"1":"13","2":"2","3":"160840.491859"},{"1":"14","2":"2","3":"169508.988921"},{"1":"15","2":"2","3":"182573.202374"},{"1":"16","2":"2","3":"193330.166605"},{"1":"17","2":"2","3":"205021.777095"},{"1":"18","2":"2","3":"213085.603584"},{"1":"19","2":"2","3":"224904.310525"},{"1":"20","2":"2","3":"228243.882244"},{"1":"21","2":"2","3":"238423.914158"},{"1":"22","2":"2","3":"251745.609271"},{"1":"23","2":"2","3":"263594.946067"},{"1":"24","2":"2","3":"273112.429247"},{"1":"25","2":"2","3":"285801.490175"},{"1":"26","2":"2","3":"294324.901120"},{"1":"27","2":"2","3":"302256.738672"},{"1":"28","2":"2","3":"307508.136109"},{"1":"29","2":"2","3":"312823.811211"},{"1":"30","2":"2","3":"319954.969802"},{"1":"31","2":"2","3":"320729.156566"},{"1":"32","2":"2","3":"327082.211831"},{"1":"33","2":"2","3":"329704.422366"},{"1":"34","2":"2","3":"333032.608408"},{"1":"35","2":"2","3":"344044.934448"},{"1":"36","2":"2","3":"351550.685158"},{"1":"37","2":"2","3":"354538.131370"},{"1":"38","2":"2","3":"356827.032942"},{"1":"39","2":"2","3":"365218.450449"},{"1":"40","2":"2","3":"370613.695438"},{"1":"41","2":"2","3":"380909.645710"},{"1":"42","2":"2","3":"388610.299215"},{"1":"43","2":"2","3":"395531.045685"},{"1":"44","2":"2","3":"400178.800562"},{"1":"45","2":"2","3":"407899.732951"},{"1":"46","2":"2","3":"410986.336672"},{"1":"47","2":"2","3":"416495.920040"},{"1":"48","2":"2","3":"421450.693953"},{"1":"49","2":"2","3":"430330.444750"},{"1":"50","2":"2","3":"433540.336183"},{"1":"0","2":"5","3":"0.000000"},{"1":"1","2":"5","3":"20645.933363"},{"1":"2","2":"5","3":"40310.213087"},{"1":"3","2":"5","3":"57890.375226"},{"1":"4","2":"5","3":"75731.258409"},{"1":"5","2":"5","3":"93541.890594"},{"1":"6","2":"5","3":"111664.580351"},{"1":"7","2":"5","3":"128469.986061"},{"1":"8","2":"5","3":"145515.581355"},{"1":"9","2":"5","3":"162963.569457"},{"1":"10","2":"5","3":"178836.961051"},{"1":"11","2":"5","3":"191400.544525"},{"1":"12","2":"5","3":"205162.760894"},{"1":"13","2":"5","3":"222363.417629"},{"1":"14","2":"5","3":"232818.341537"},{"1":"15","2":"5","3":"249224.916071"},{"1":"16","2":"5","3":"261260.781446"},{"1":"17","2":"5","3":"272210.195355"},{"1":"18","2":"5","3":"278144.089099"},{"1":"19","2":"5","3":"294196.585877"},{"1":"20","2":"5","3":"310744.628078"},{"1":"21","2":"5","3":"327416.992091"},{"1":"22","2":"5","3":"336007.877339"},{"1":"23","2":"5","3":"351649.893016"},{"1":"24","2":"5","3":"362045.917337"},{"1":"25","2":"5","3":"373765.617802"},{"1":"26","2":"5","3":"386669.511566"},{"1":"27","2":"5","3":"397631.010581"},{"1":"28","2":"5","3":"406482.069225"},{"1":"29","2":"5","3":"412290.985401"},{"1":"30","2":"5","3":"428950.361399"},{"1":"31","2":"5","3":"435605.324573"},{"1":"32","2":"5","3":"446857.784685"},{"1":"33","2":"5","3":"462141.680443"},{"1":"34","2":"5","3":"474316.127249"},{"1":"35","2":"5","3":"488076.778735"},{"1":"36","2":"5","3":"501036.965146"},{"1":"37","2":"5","3":"504824.686663"},{"1":"38","2":"5","3":"511100.813305"},{"1":"39","2":"5","3":"519248.059639"},{"1":"40","2":"5","3":"525609.934994"},{"1":"41","2":"5","3":"537287.566455"},{"1":"42","2":"5","3":"549026.813608"},{"1":"43","2":"5","3":"558614.468220"},{"1":"44","2":"5","3":"570959.455200"},{"1":"45","2":"5","3":"577194.400353"},{"1":"46","2":"5","3":"583891.360233"},{"1":"47","2":"5","3":"592984.667035"},{"1":"48","2":"5","3":"604154.987762"},{"1":"49","2":"5","3":"617943.347884"},{"1":"50","2":"5","3":"631391.133096"},{"1":"0","2":"10","3":"0.000000"},{"1":"1","2":"10","3":"22685.580474"},{"1":"2","2":"10","3":"45818.714686"},{"1":"3","2":"10","3":"66073.535656"},{"1":"4","2":"10","3":"86597.508457"},{"1":"5","2":"10","3":"104426.087634"},{"1":"6","2":"10","3":"121831.750778"},{"1":"7","2":"10","3":"138994.010528"},{"1":"8","2":"10","3":"154295.117215"},{"1":"9","2":"10","3":"172742.354636"},{"1":"10","2":"10","3":"191685.247983"},{"1":"11","2":"10","3":"207537.928963"},{"1":"12","2":"10","3":"225612.616864"},{"1":"13","2":"10","3":"238148.502331"},{"1":"14","2":"10","3":"255203.333943"},{"1":"15","2":"10","3":"270908.838736"},{"1":"16","2":"10","3":"280324.811783"},{"1":"17","2":"10","3":"295682.175688"},{"1":"18","2":"10","3":"312887.018786"},{"1":"19","2":"10","3":"323220.123283"},{"1":"20","2":"10","3":"338410.172763"},{"1":"21","2":"10","3":"346860.650649"},{"1":"22","2":"10","3":"354644.112143"},{"1":"23","2":"10","3":"368982.687567"},{"1":"24","2":"10","3":"383426.959952"},{"1":"25","2":"10","3":"394943.430493"},{"1":"26","2":"10","3":"404621.793738"},{"1":"27","2":"10","3":"411633.987658"},{"1":"28","2":"10","3":"424468.637234"},{"1":"29","2":"10","3":"439388.344057"},{"1":"30","2":"10","3":"449529.217397"},{"1":"31","2":"10","3":"459068.906639"},{"1":"32","2":"10","3":"473596.462106"},{"1":"33","2":"10","3":"491455.409295"},{"1":"34","2":"10","3":"505087.958783"},{"1":"35","2":"10","3":"513579.469051"},{"1":"36","2":"10","3":"525470.184426"},{"1":"37","2":"10","3":"536651.357763"},{"1":"38","2":"10","3":"542989.780887"},{"1":"39","2":"10","3":"551577.575203"},{"1":"40","2":"10","3":"562103.623458"},{"1":"41","2":"10","3":"573962.240376"},{"1":"42","2":"10","3":"582141.563192"},{"1":"43","2":"10","3":"589628.590914"},{"1":"44","2":"10","3":"603864.359645"},{"1":"45","2":"10","3":"614558.476793"},{"1":"46","2":"10","3":"625138.787569"},{"1":"47","2":"10","3":"626311.164530"},{"1":"48","2":"10","3":"628749.693138"},{"1":"49","2":"10","3":"637286.546720"},{"1":"50","2":"10","3":"649904.828811"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">step</span>, y <span class="op">=</span> <span class="va">mean</span>, color <span class="op">=</span> <span class="va">sensing_radius</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">50</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">700000</span>, <span class="fl">100000</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/formatc.html">prettyNum</a></span><span class="op">(</span><span class="va">.x</span>, big.mark <span class="op">=</span> <span class="st">","</span><span class="op">)</span>,</span>
<span>    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">700000</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Mean investor wealth"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"Sensing radius"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">brandr</span><span class="fu">::</span><span class="fu"><a href="https://danielvartan.github.io/brandr/reference/scale_brand.html">scale_color_brand_d</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="index_files/figure-html/unnamed-chunk-10-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section></section><section id="model-11.5" class="level2"><h2 class="anchored" data-anchor-id="model-11.5">Model 11.5</h2>
<section id="figure-12.1" class="level3"><h3 class="anchored" data-anchor-id="figure-12.1">Figure 12.1</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span></span>
<span>    <span class="st">"data"</span>,</span>
<span>    <span class="st">"business-investor-model-11-5-figure-12-1-table.csv"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span></span>
<span>    skip <span class="op">=</span> <span class="fl">6</span>,</span>
<span>    col_types <span class="op">=</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/cols.html">cols</a></span><span class="op">(</span>.default <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/clean_names.html">clean_names</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span></span>
<span>    <span class="va">run_number</span>,</span>
<span>    <span class="va">decision_time_horizon</span>,</span>
<span>    <span class="va">mean_wealth_of_investors</span>,</span>
<span>    <span class="va">mean_profit_of_turtles_on_patches</span>,</span>
<span>    <span class="va">mean_risk_of_failing_of_turtles_on_patches</span>,</span>
<span>    <span class="va">total_business_failures</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span></span>
<span>      .cols <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      .fns <span class="op">=</span> <span class="va">as.numeric</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    decision_time_horizon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">decision_time_horizon</span>, ordered <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["run_number"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["decision_time_horizon"],"name":[2],"type":["ord"],"align":["right"]},{"label":["mean_wealth_of_investors"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["mean_profit_of_turtles_on_patches"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["mean_risk_of_failing_of_turtles_on_patches"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["total_business_failures"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"7","2":"1","3":"274258.2914","4":"9604.157265","5":"0.02183027785","6":"42"},{"1":"9","2":"1","3":"296334.7152","4":"8488.981526","5":"0.02172758644","6":"36"},{"1":"1","2":"1","3":"317360.8305","4":"9065.159845","5":"0.02460194791","6":"30"},{"1":"3","2":"1","3":"276734.3952","4":"7496.619127","5":"0.02567037362","6":"39"},{"1":"4","2":"1","3":"415585.1736","4":"12231.576366","5":"0.02453942990","6":"30"},{"1":"2","2":"1","3":"381810.4829","4":"9805.205906","5":"0.02468896457","6":"31"},{"1":"5","2":"1","3":"273001.8644","4":"7842.355183","5":"0.01850690323","6":"40"},{"1":"8","2":"1","3":"322720.3383","4":"8157.022330","5":"0.02255238701","6":"24"},{"1":"6","2":"1","3":"300512.2287","4":"9090.731971","5":"0.02797766863","6":"37"},{"1":"10","2":"1","3":"347721.7289","4":"8842.585433","5":"0.02022004055","6":"32"},{"1":"13","2":"2","3":"255561.3644","4":"6623.809762","5":"0.02060106861","6":"37"},{"1":"14","2":"2","3":"296500.2127","4":"7829.298886","5":"0.02351074602","6":"29"},{"1":"11","2":"2","3":"296514.6204","4":"8472.548887","5":"0.02799359918","6":"40"},{"1":"12","2":"2","3":"332347.3988","4":"8618.026348","5":"0.02532339180","6":"39"},{"1":"15","2":"2","3":"294806.9202","4":"7544.437828","5":"0.02244336179","6":"37"},{"1":"17","2":"2","3":"272420.7948","4":"8253.745202","5":"0.02362466527","6":"47"},{"1":"16","2":"2","3":"368986.2745","4":"11492.497290","5":"0.02632957486","6":"40"},{"1":"18","2":"2","3":"219180.2994","4":"6563.951110","5":"0.02674476031","6":"49"},{"1":"19","2":"2","3":"285731.4336","4":"8717.555507","5":"0.02874107443","6":"39"},{"1":"20","2":"2","3":"301936.5853","4":"7816.721145","5":"0.02167033911","6":"33"},{"1":"22","2":"3","3":"282358.8421","4":"9421.374607","5":"0.02518450503","6":"41"},{"1":"21","2":"3","3":"374079.8941","4":"9965.336274","5":"0.01902547179","6":"23"},{"1":"26","2":"3","3":"268930.7065","4":"8713.771866","5":"0.02465903045","6":"43"},{"1":"23","2":"3","3":"281315.5771","4":"7394.128535","5":"0.02209443948","6":"36"},{"1":"28","2":"3","3":"259726.0192","4":"7217.762472","5":"0.02076851039","6":"49"},{"1":"25","2":"3","3":"301079.3283","4":"10072.123039","5":"0.02424415322","6":"38"},{"1":"27","2":"3","3":"354825.8291","4":"8752.437046","5":"0.02346793525","6":"42"},{"1":"24","2":"3","3":"388708.1118","4":"8901.654158","5":"0.01799044318","6":"38"},{"1":"29","2":"3","3":"456015.1655","4":"9542.166913","5":"0.01484964143","6":"17"},{"1":"30","2":"3","3":"366448.6497","4":"9769.298924","5":"0.02419065885","6":"31"},{"1":"34","2":"4","3":"294518.1017","4":"8491.565440","5":"0.02901537327","6":"42"},{"1":"31","2":"4","3":"296187.9473","4":"8032.109146","5":"0.02698557891","6":"35"},{"1":"32","2":"4","3":"255422.8767","4":"7761.192329","5":"0.02542458828","6":"45"},{"1":"36","2":"4","3":"325030.0696","4":"7897.896231","5":"0.01967746898","6":"32"},{"1":"37","2":"4","3":"306637.7289","4":"9283.409825","5":"0.02003670254","6":"37"},{"1":"35","2":"4","3":"269607.4298","4":"9569.918944","5":"0.03203207021","6":"35"},{"1":"33","2":"4","3":"202788.7780","4":"7071.732149","5":"0.02207245874","6":"42"},{"1":"38","2":"4","3":"236416.3637","4":"6874.745837","5":"0.02350638772","6":"36"},{"1":"40","2":"4","3":"282218.5304","4":"6466.068621","5":"0.02043687719","6":"38"},{"1":"43","2":"5","3":"227636.4289","4":"6978.828261","5":"0.02848703404","6":"37"},{"1":"41","2":"5","3":"382577.0579","4":"8573.797868","5":"0.02083658780","6":"38"},{"1":"42","2":"5","3":"274643.1323","4":"8996.105958","5":"0.02985464593","6":"30"},{"1":"39","2":"4","3":"338545.9899","4":"9006.813587","5":"0.02005855170","6":"33"},{"1":"48","2":"5","3":"310567.8665","4":"9750.175102","5":"0.01895889941","6":"51"},{"1":"45","2":"5","3":"246795.5999","4":"9028.906167","5":"0.02331702078","6":"34"},{"1":"49","2":"5","3":"280121.0464","4":"9145.263572","5":"0.01785728809","6":"40"},{"1":"46","2":"5","3":"379391.8300","4":"9275.454136","5":"0.02174934897","6":"21"},{"1":"47","2":"5","3":"285523.0223","4":"8144.658671","5":"0.02951919690","6":"43"},{"1":"50","2":"5","3":"259855.8710","4":"8502.990227","5":"0.02642720215","6":"48"},{"1":"52","2":"6","3":"327511.4268","4":"6535.791383","5":"0.01705675456","6":"33"},{"1":"44","2":"5","3":"423275.0776","4":"8536.902361","5":"0.01766285413","6":"31"},{"1":"53","2":"6","3":"316804.0392","4":"8217.205130","5":"0.01869206906","6":"37"},{"1":"51","2":"6","3":"209007.8757","4":"7197.628385","5":"0.02932793521","6":"38"},{"1":"55","2":"6","3":"366072.8457","4":"9212.400953","5":"0.02198694899","6":"32"},{"1":"58","2":"6","3":"314749.7073","4":"7158.991897","5":"0.01929518881","6":"36"},{"1":"57","2":"6","3":"292688.6813","4":"7016.915923","5":"0.01572959200","6":"29"},{"1":"56","2":"6","3":"357969.3668","4":"9502.795352","5":"0.01917370419","6":"28"},{"1":"54","2":"6","3":"255085.3251","4":"8096.591049","5":"0.02129261687","6":"37"},{"1":"61","2":"7","3":"292291.0350","4":"8566.109821","5":"0.03373460476","6":"36"},{"1":"59","2":"6","3":"374307.8796","4":"9748.995301","5":"0.02479107881","6":"33"},{"1":"60","2":"6","3":"350899.9130","4":"9312.448154","5":"0.02153197659","6":"38"},{"1":"64","2":"7","3":"334747.9139","4":"9237.414182","5":"0.01959120309","6":"37"},{"1":"63","2":"7","3":"356701.2094","4":"8714.669691","5":"0.02367602678","6":"24"},{"1":"65","2":"7","3":"237203.9414","4":"8932.730719","5":"0.02594178657","6":"43"},{"1":"62","2":"7","3":"337527.1034","4":"10337.359292","5":"0.01922443909","6":"36"},{"1":"70","2":"7","3":"347151.5119","4":"7121.209629","5":"0.02049192871","6":"41"},{"1":"66","2":"7","3":"328403.5935","4":"9401.056214","5":"0.02520723594","6":"35"},{"1":"69","2":"7","3":"329844.5718","4":"9112.445786","5":"0.02148965695","6":"37"},{"1":"68","2":"7","3":"318578.2493","4":"8024.479524","5":"0.01878100378","6":"32"},{"1":"72","2":"8","3":"280759.6896","4":"7809.613651","5":"0.01917400876","6":"21"},{"1":"73","2":"8","3":"292822.9626","4":"8807.476732","5":"0.01977155855","6":"38"},{"1":"67","2":"7","3":"269292.5007","4":"8348.718098","5":"0.02665558562","6":"43"},{"1":"71","2":"8","3":"268071.9592","4":"8515.124778","5":"0.02044494509","6":"42"},{"1":"74","2":"8","3":"357443.0017","4":"10506.944025","5":"0.02270695173","6":"28"},{"1":"77","2":"8","3":"239418.4565","4":"7830.190516","5":"0.02189845170","6":"33"},{"1":"78","2":"8","3":"388783.2416","4":"9209.149607","5":"0.01792026301","6":"28"},{"1":"80","2":"8","3":"380175.6236","4":"9016.457675","5":"0.02173434260","6":"22"},{"1":"75","2":"8","3":"329743.1149","4":"9625.803168","5":"0.02201290081","6":"39"},{"1":"76","2":"8","3":"377129.5474","4":"8885.197855","5":"0.01658923089","6":"23"},{"1":"79","2":"8","3":"294213.4304","4":"7875.028230","5":"0.01985218268","6":"40"},{"1":"82","2":"9","3":"352776.2469","4":"8368.054539","5":"0.01874656715","6":"26"},{"1":"85","2":"9","3":"272607.4245","4":"8070.458045","5":"0.02542600379","6":"42"},{"1":"81","2":"9","3":"236292.1076","4":"8583.242481","5":"0.03222819136","6":"38"},{"1":"83","2":"9","3":"291614.0295","4":"8546.075066","5":"0.02312654215","6":"33"},{"1":"84","2":"9","3":"369322.4130","4":"9335.021062","5":"0.02231678488","6":"30"},{"1":"89","2":"9","3":"260394.7980","4":"6950.702226","5":"0.02340264586","6":"26"},{"1":"87","2":"9","3":"199064.0694","4":"8043.166043","5":"0.02287699951","6":"48"},{"1":"86","2":"9","3":"250206.0663","4":"6338.457829","5":"0.01769772357","6":"37"},{"1":"88","2":"9","3":"249735.5095","4":"8677.734394","5":"0.03256525684","6":"39"},{"1":"91","2":"10","3":"270461.0242","4":"6806.199351","5":"0.02224614654","6":"33"},{"1":"93","2":"10","3":"251454.3555","4":"9107.328390","5":"0.02484644927","6":"34"},{"1":"90","2":"9","3":"271106.5708","4":"7808.531273","5":"0.02371000746","6":"39"},{"1":"94","2":"10","3":"273490.3246","4":"7275.306011","5":"0.02210539189","6":"30"},{"1":"95","2":"10","3":"290504.2272","4":"8261.159443","5":"0.02477276386","6":"39"},{"1":"92","2":"10","3":"363162.9088","4":"9134.901935","5":"0.01664855495","6":"27"},{"1":"96","2":"10","3":"222398.5991","4":"7341.198361","5":"0.02689221911","6":"36"},{"1":"97","2":"10","3":"292690.3171","4":"9055.169896","5":"0.03005627718","6":"34"},{"1":"98","2":"10","3":"298958.0234","4":"6375.620607","5":"0.01694368934","6":"25"},{"1":"99","2":"10","3":"233107.9902","4":"6258.950401","5":"0.01960793775","6":"29"},{"1":"102","2":"11","3":"255446.5138","4":"6464.895457","5":"0.02364708564","6":"38"},{"1":"101","2":"11","3":"325919.5952","4":"10053.379475","5":"0.02008589287","6":"34"},{"1":"100","2":"10","3":"323882.5377","4":"7124.330262","5":"0.01969488178","6":"22"},{"1":"103","2":"11","3":"368228.0212","4":"8373.188647","5":"0.01660176173","6":"20"},{"1":"104","2":"11","3":"398852.6398","4":"9705.664486","5":"0.02053828670","6":"29"},{"1":"106","2":"11","3":"320706.7272","4":"8356.048155","5":"0.02546552161","6":"30"},{"1":"105","2":"11","3":"365010.2799","4":"8067.353288","5":"0.01821163841","6":"30"},{"1":"109","2":"11","3":"355561.4650","4":"9981.573333","5":"0.02042147739","6":"30"},{"1":"107","2":"11","3":"335793.5513","4":"8748.099912","5":"0.01971239975","6":"27"},{"1":"108","2":"11","3":"261660.0867","4":"7913.729908","5":"0.02497125276","6":"31"},{"1":"111","2":"12","3":"247123.0359","4":"8061.404677","5":"0.02568516195","6":"41"},{"1":"110","2":"11","3":"321541.5574","4":"8104.953369","5":"0.02150757828","6":"37"},{"1":"113","2":"12","3":"253582.7827","4":"7485.553891","5":"0.02260317224","6":"27"},{"1":"112","2":"12","3":"258465.1613","4":"7113.095967","5":"0.02117069092","6":"28"},{"1":"115","2":"12","3":"278484.5649","4":"8070.109748","5":"0.02261975072","6":"45"},{"1":"114","2":"12","3":"431017.5969","4":"8132.596764","5":"0.01415346573","6":"26"},{"1":"116","2":"12","3":"287713.8019","4":"7458.853617","5":"0.01879552076","6":"33"},{"1":"118","2":"12","3":"309150.5357","4":"6378.454328","5":"0.01565242136","6":"28"},{"1":"117","2":"12","3":"409119.4917","4":"10595.911098","5":"0.02389407231","6":"43"},{"1":"120","2":"12","3":"263232.6484","4":"5807.669406","5":"0.01927555264","6":"24"},{"1":"119","2":"12","3":"357394.8864","4":"9428.031874","5":"0.02013449673","6":"30"},{"1":"126","2":"13","3":"310448.6156","4":"7398.232394","5":"0.02015546078","6":"32"},{"1":"121","2":"13","3":"333851.6463","4":"7871.586521","5":"0.01896739981","6":"30"},{"1":"123","2":"13","3":"380786.7431","4":"9056.303541","5":"0.01987180623","6":"33"},{"1":"122","2":"13","3":"304816.3965","4":"8748.113965","5":"0.02178871300","6":"31"},{"1":"124","2":"13","3":"286329.9484","4":"7504.913725","5":"0.02413001549","6":"33"},{"1":"128","2":"13","3":"323594.4770","4":"8644.497238","5":"0.01880403483","6":"29"},{"1":"127","2":"13","3":"345494.4316","4":"9680.796027","5":"0.01998035625","6":"27"},{"1":"131","2":"14","3":"227570.0418","4":"7393.343691","5":"0.02460299294","6":"29"},{"1":"130","2":"13","3":"289917.2859","4":"7135.778048","5":"0.01864440344","6":"38"},{"1":"129","2":"13","3":"348375.6093","4":"8791.411859","5":"0.02212782883","6":"20"},{"1":"133","2":"14","3":"257500.0672","4":"8148.432534","5":"0.01968495023","6":"38"},{"1":"132","2":"14","3":"270492.1407","4":"7354.584860","5":"0.02226601203","6":"32"},{"1":"125","2":"13","3":"314994.8991","4":"7214.024533","5":"0.01874394191","6":"24"},{"1":"135","2":"14","3":"305973.4235","4":"7172.592791","5":"0.01817006315","6":"29"},{"1":"134","2":"14","3":"298245.7729","4":"7418.060310","5":"0.01777675163","6":"34"},{"1":"137","2":"14","3":"267831.0008","4":"8108.391321","5":"0.02300125271","6":"33"},{"1":"138","2":"14","3":"294691.7269","4":"7706.203054","5":"0.02126091680","6":"32"},{"1":"140","2":"14","3":"232075.5912","4":"9117.229170","5":"0.01755872511","6":"42"},{"1":"139","2":"14","3":"338002.8464","4":"8203.145624","5":"0.02182407920","6":"22"},{"1":"136","2":"14","3":"248110.0246","4":"7437.270274","5":"0.01927575370","6":"41"},{"1":"142","2":"15","3":"316843.4197","4":"7146.818339","5":"0.01648437128","6":"25"},{"1":"146","2":"15","3":"386351.2298","4":"8899.324548","5":"0.02158273460","6":"27"},{"1":"144","2":"15","3":"333272.2388","4":"6925.154201","5":"0.01492585511","6":"25"},{"1":"148","2":"15","3":"372751.7983","4":"8824.894670","5":"0.02099022641","6":"25"},{"1":"145","2":"15","3":"378875.6119","4":"9658.081246","5":"0.01645785680","6":"28"},{"1":"147","2":"15","3":"320588.5128","4":"9734.633747","5":"0.02370199398","6":"26"},{"1":"149","2":"15","3":"325435.3489","4":"8688.712597","5":"0.02303859761","6":"33"},{"1":"150","2":"15","3":"362212.5294","4":"9142.323358","5":"0.02109047459","6":"22"},{"1":"151","2":"16","3":"297130.5199","4":"8330.913990","5":"0.02200193058","6":"33"},{"1":"141","2":"15","3":"273261.5976","4":"7445.733684","5":"0.01945684564","6":"39"},{"1":"156","2":"16","3":"357095.9769","4":"8353.579737","5":"0.01947937003","6":"29"},{"1":"153","2":"16","3":"351173.0939","4":"7230.403189","5":"0.01505244292","6":"26"},{"1":"152","2":"16","3":"316944.4489","4":"9601.557888","5":"0.02109858030","6":"25"},{"1":"154","2":"16","3":"351738.1839","4":"8265.699022","5":"0.01601525385","6":"22"},{"1":"155","2":"16","3":"356229.4141","4":"7601.487085","5":"0.01717074337","6":"29"},{"1":"143","2":"15","3":"413855.6623","4":"9495.887933","5":"0.01413717987","6":"29"},{"1":"157","2":"16","3":"219403.0046","4":"7516.075496","5":"0.02058123185","6":"27"},{"1":"158","2":"16","3":"307945.0212","4":"7300.753019","5":"0.01787841274","6":"18"},{"1":"159","2":"16","3":"282552.1153","4":"7423.360480","5":"0.01567456494","6":"36"},{"1":"160","2":"16","3":"322929.7461","4":"6394.035216","5":"0.01474125391","6":"30"},{"1":"164","2":"17","3":"322867.2481","4":"8618.578196","5":"0.01642239971","6":"35"},{"1":"163","2":"17","3":"211688.0756","4":"7151.355674","5":"0.02143263020","6":"26"},{"1":"161","2":"17","3":"292757.6536","4":"6933.410004","5":"0.01908861904","6":"27"},{"1":"162","2":"17","3":"261239.1985","4":"7597.300122","5":"0.02019906171","6":"33"},{"1":"166","2":"17","3":"346791.2747","4":"9505.019305","5":"0.01571902662","6":"41"},{"1":"165","2":"17","3":"319366.8205","4":"7054.653819","5":"0.01944973174","6":"25"},{"1":"167","2":"17","3":"259505.9146","4":"6961.570106","5":"0.01866776694","6":"27"},{"1":"170","2":"17","3":"280570.1490","4":"6211.067854","5":"0.01536233262","6":"32"},{"1":"172","2":"18","3":"232568.9868","4":"7120.609196","5":"0.02424334257","6":"34"},{"1":"168","2":"17","3":"347100.8441","4":"7941.011124","5":"0.01841890814","6":"23"},{"1":"169","2":"17","3":"274211.6954","4":"6213.249742","5":"0.02423056964","6":"28"},{"1":"173","2":"18","3":"216980.2174","4":"7040.113716","5":"0.02179579405","6":"39"},{"1":"171","2":"18","3":"286855.2444","4":"7557.453924","5":"0.01979427531","6":"33"},{"1":"176","2":"18","3":"246615.5792","4":"6063.806503","5":"0.01626846184","6":"32"},{"1":"179","2":"18","3":"397912.3968","4":"9884.660796","5":"0.01800828378","6":"21"},{"1":"175","2":"18","3":"463303.0403","4":"9818.931219","5":"0.01802395403","6":"25"},{"1":"174","2":"18","3":"249082.3706","4":"7778.321461","5":"0.02626751842","6":"28"},{"1":"177","2":"18","3":"394192.2257","4":"10578.799153","5":"0.01997667930","6":"19"},{"1":"181","2":"19","3":"344105.0770","4":"8256.252973","5":"0.01881446630","6":"21"},{"1":"182","2":"19","3":"305123.7020","4":"7385.813497","5":"0.02026272136","6":"16"},{"1":"178","2":"18","3":"406913.4257","4":"11379.742969","5":"0.01916160782","6":"24"},{"1":"180","2":"18","3":"256025.0336","4":"8480.388953","5":"0.02854426350","6":"30"},{"1":"183","2":"19","3":"192395.8307","4":"6248.244082","5":"0.02280046794","6":"33"},{"1":"184","2":"19","3":"336125.4636","4":"8795.267994","5":"0.01759511313","6":"19"},{"1":"185","2":"19","3":"190016.0762","4":"5404.068432","5":"0.02023211253","6":"38"},{"1":"188","2":"19","3":"249502.5896","4":"7805.077456","5":"0.02060521488","6":"30"},{"1":"186","2":"19","3":"302927.8082","4":"5687.936871","5":"0.01100940086","6":"16"},{"1":"190","2":"19","3":"336291.0025","4":"8682.333808","5":"0.02126956036","6":"30"},{"1":"189","2":"19","3":"323273.3020","4":"5790.466314","5":"0.01434755926","6":"14"},{"1":"187","2":"19","3":"232326.5860","4":"8009.625370","5":"0.02419352488","6":"36"},{"1":"192","2":"20","3":"246479.4847","4":"7739.904256","5":"0.02182643232","6":"30"},{"1":"193","2":"20","3":"285964.3110","4":"8567.027965","5":"0.01969048447","6":"27"},{"1":"191","2":"20","3":"232332.1712","4":"6233.887484","5":"0.01727965323","6":"33"},{"1":"198","2":"20","3":"353614.5040","4":"8240.274916","5":"0.01694682308","6":"18"},{"1":"194","2":"20","3":"333518.7708","4":"8931.953450","5":"0.01907378568","6":"21"},{"1":"195","2":"20","3":"336391.8282","4":"10196.598465","5":"0.02288239913","6":"33"},{"1":"199","2":"20","3":"246819.2196","4":"6942.757168","5":"0.02137701310","6":"28"},{"1":"196","2":"20","3":"415478.1618","4":"8627.348426","5":"0.01649003638","6":"22"},{"1":"197","2":"20","3":"283419.1999","4":"8108.929506","5":"0.01709617752","6":"30"},{"1":"200","2":"20","3":"216165.6080","4":"7012.749357","5":"0.02048627624","6":"41"},{"1":"201","2":"21","3":"221668.9893","4":"4980.891577","5":"0.01680767741","6":"28"},{"1":"204","2":"21","3":"277006.8838","4":"7611.839713","5":"0.01879558001","6":"32"},{"1":"202","2":"21","3":"387018.9018","4":"9580.670021","5":"0.01616532333","6":"18"},{"1":"203","2":"21","3":"299815.3688","4":"7928.713489","5":"0.01667330732","6":"29"},{"1":"206","2":"21","3":"357092.9078","4":"8655.698721","5":"0.01890459604","6":"37"},{"1":"205","2":"21","3":"387777.1426","4":"8207.539371","5":"0.01866599919","6":"21"},{"1":"207","2":"21","3":"256915.3523","4":"9050.924562","5":"0.02200377512","6":"28"},{"1":"208","2":"21","3":"250221.6566","4":"5640.221772","5":"0.01740243143","6":"23"},{"1":"209","2":"21","3":"382821.2900","4":"9882.959901","5":"0.01752133429","6":"26"},{"1":"210","2":"21","3":"220134.2136","4":"8601.376840","5":"0.02181981660","6":"38"},{"1":"213","2":"22","3":"249750.8373","4":"6374.881573","5":"0.01995946832","6":"24"},{"1":"211","2":"22","3":"303362.9128","4":"9104.471807","5":"0.02400147707","6":"33"},{"1":"214","2":"22","3":"298382.7257","4":"9141.705922","5":"0.02192476131","6":"34"},{"1":"212","2":"22","3":"252124.8023","4":"6087.489808","5":"0.01849050140","6":"26"},{"1":"216","2":"22","3":"307817.3341","4":"7683.294951","5":"0.02522028620","6":"31"},{"1":"218","2":"22","3":"334252.8895","4":"9397.340042","5":"0.02061284251","6":"26"},{"1":"215","2":"22","3":"284089.9445","4":"8855.698336","5":"0.01969894222","6":"24"},{"1":"221","2":"23","3":"325274.6233","4":"8170.396258","5":"0.01342087239","6":"19"},{"1":"220","2":"22","3":"266503.5007","4":"6610.418469","5":"0.01687374292","6":"28"},{"1":"219","2":"22","3":"387380.7644","4":"8329.143909","5":"0.01633334008","6":"20"},{"1":"217","2":"22","3":"241052.7988","4":"8069.490658","5":"0.02573545188","6":"38"},{"1":"222","2":"23","3":"359798.4933","4":"6843.461727","5":"0.01721496752","6":"23"},{"1":"223","2":"23","3":"322477.8754","4":"7488.814067","5":"0.01572071091","6":"23"},{"1":"224","2":"23","3":"295653.1804","4":"7856.320621","5":"0.01875466457","6":"15"},{"1":"225","2":"23","3":"292301.1362","4":"7331.942636","5":"0.01955583442","6":"22"},{"1":"226","2":"23","3":"316274.7292","4":"8455.967556","5":"0.01562602207","6":"22"},{"1":"229","2":"23","3":"292253.8121","4":"7584.384683","5":"0.02193530175","6":"28"},{"1":"228","2":"23","3":"330709.1793","4":"8658.516399","5":"0.02028771500","6":"27"},{"1":"227","2":"23","3":"275450.2862","4":"6490.728132","5":"0.01892089971","6":"30"},{"1":"230","2":"23","3":"314018.9644","4":"7603.571388","5":"0.01714172508","6":"29"},{"1":"232","2":"24","3":"233389.6346","4":"6641.621510","5":"0.01240541640","6":"27"},{"1":"234","2":"24","3":"283864.6991","4":"9310.942926","5":"0.01946261684","6":"29"},{"1":"233","2":"24","3":"275026.4270","4":"8458.492876","5":"0.01988057510","6":"35"},{"1":"235","2":"24","3":"285640.9794","4":"8935.682193","5":"0.02175693065","6":"32"},{"1":"231","2":"24","3":"338639.7715","4":"9168.884504","5":"0.02052970566","6":"22"},{"1":"241","2":"25","3":"317715.4212","4":"9090.428154","5":"0.01528151824","6":"26"},{"1":"236","2":"24","3":"265630.0964","4":"7003.377818","5":"0.01782213741","6":"25"},{"1":"240","2":"24","3":"332987.9031","4":"8901.462664","5":"0.01704285020","6":"23"},{"1":"237","2":"24","3":"353987.5461","4":"8898.961410","5":"0.01633298578","6":"11"},{"1":"238","2":"24","3":"269663.0433","4":"6805.075483","5":"0.01771117681","6":"26"},{"1":"242","2":"25","3":"288711.3720","4":"7218.921180","5":"0.01522279064","6":"28"},{"1":"239","2":"24","3":"241730.0062","4":"6216.006598","5":"0.01642754177","6":"27"},{"1":"243","2":"25","3":"242047.9219","4":"7282.690932","5":"0.02416029874","6":"29"},{"1":"246","2":"25","3":"242673.1676","4":"6702.972443","5":"0.01878702715","6":"23"},{"1":"244","2":"25","3":"295086.6568","4":"8964.117136","5":"0.02628050589","6":"26"},{"1":"245","2":"25","3":"264868.9596","4":"7174.832066","5":"0.02137543262","6":"31"},{"1":"247","2":"25","3":"293400.8349","4":"9215.236448","5":"0.02446341803","6":"26"},{"1":"248","2":"25","3":"293674.6143","4":"7514.820307","5":"0.01803775016","6":"23"},{"1":"249","2":"25","3":"341876.7302","4":"9591.486931","5":"0.01850929442","6":"22"},{"1":"250","2":"25","3":"240656.5636","4":"7081.004451","5":"0.01653050817","6":"27"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plot_1</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span></span>
<span>    mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">mean_wealth_of_investors</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    sd <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">mean_wealth_of_investors</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    .by <span class="op">=</span> <span class="va">decision_time_horizon</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">decision_time_horizon</span>,</span>
<span>      y <span class="op">=</span> <span class="va">mean</span>,</span>
<span>      ymin <span class="op">=</span> <span class="va">mean</span> <span class="op">-</span> <span class="va">sd</span>,</span>
<span>      ymax <span class="op">=</span> <span class="va">mean</span> <span class="op">+</span> <span class="va">sd</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">19</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_errorbar</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_x_discrete</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">25</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">400000</span>, <span class="fl">100000</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/formatc.html">prettyNum</a></span><span class="op">(</span><span class="va">.x</span>, big.mark <span class="op">=</span> <span class="st">","</span><span class="op">)</span>,</span>
<span>    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">400000</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Time horizon (years)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Mean final investor wealth"</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plot_2</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span></span>
<span>    mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">total_business_failures</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    sd <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">total_business_failures</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    .by <span class="op">=</span> <span class="va">decision_time_horizon</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">decision_time_horizon</span>,</span>
<span>      y <span class="op">=</span> <span class="va">mean</span>,</span>
<span>      ymin <span class="op">=</span> <span class="va">mean</span> <span class="op">-</span> <span class="va">sd</span>,</span>
<span>      ymax <span class="op">=</span> <span class="va">mean</span> <span class="op">+</span> <span class="va">sd</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">19</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_errorbar</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_x_discrete</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">25</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">80</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Time horizon (years)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Number of failures"</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plot_3</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span></span>
<span>    mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">mean_profit_of_turtles_on_patches</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    sd <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">mean_profit_of_turtles_on_patches</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    .by <span class="op">=</span> <span class="va">decision_time_horizon</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">decision_time_horizon</span>,</span>
<span>      y <span class="op">=</span> <span class="va">mean</span>,</span>
<span>      ymin <span class="op">=</span> <span class="va">mean</span> <span class="op">-</span> <span class="va">sd</span>,</span>
<span>      ymax <span class="op">=</span> <span class="va">mean</span> <span class="op">+</span> <span class="va">sd</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">19</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_errorbar</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_x_discrete</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">25</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">15000</span>, <span class="fl">5000</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/formatc.html">prettyNum</a></span><span class="op">(</span><span class="va">.x</span>, big.mark <span class="op">=</span> <span class="st">","</span><span class="op">)</span>,</span>
<span>    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">15000</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Time horizon (years)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Mean annual profit"</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plot_4</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span></span>
<span>    mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span></span>
<span>      <span class="va">mean_risk_of_failing_of_turtles_on_patches</span>,</span>
<span>      na.rm <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span>,</span>
<span>    sd <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span></span>
<span>      <span class="va">mean_risk_of_failing_of_turtles_on_patches</span>,</span>
<span>      na.rm <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span>,</span>
<span>    .by <span class="op">=</span> <span class="va">decision_time_horizon</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">decision_time_horizon</span>,</span>
<span>      y <span class="op">=</span> <span class="va">mean</span>,</span>
<span>      ymin <span class="op">=</span> <span class="va">mean</span> <span class="op">-</span> <span class="va">sd</span>,</span>
<span>      ymax <span class="op">=</span> <span class="va">mean</span> <span class="op">+</span> <span class="va">sd</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">19</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_errorbar</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_x_discrete</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">25</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.05</span>, <span class="fl">0.01</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/formatc.html">prettyNum</a></span><span class="op">(</span><span class="va">.x</span>, big.mark <span class="op">=</span> <span class="st">","</span><span class="op">)</span>,</span>
<span>    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.05</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Time horizon (years)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Mean annual risk"</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">patchwork</span><span class="fu">::</span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html">wrap_plots</a></span><span class="op">(</span></span>
<span>  <span class="va">plot_1</span>, <span class="va">plot_2</span>, <span class="va">plot_3</span>, <span class="va">plot_4</span>,</span>
<span>  ncol <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  axes <span class="op">=</span> <span class="st">"collect_x"</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="index_files/figure-html/unnamed-chunk-18-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="index_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="768"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="figure-12.2" class="level3"><h3 class="anchored" data-anchor-id="figure-12.2">Figure 12.2</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span></span>
<span>    <span class="st">"data"</span>,</span>
<span>    <span class="st">"business-investor-model-11-5-figure-12-2-table.csv"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span></span>
<span>    skip <span class="op">=</span> <span class="fl">6</span>,</span>
<span>    col_types <span class="op">=</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/cols.html">cols</a></span><span class="op">(</span>.default <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/clean_names.html">clean_names</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span></span>
<span>    <span class="va">run_number</span>,</span>
<span>    <span class="va">step</span>,</span>
<span>    <span class="va">decision_time_horizon</span>,</span>
<span>    <span class="va">mean_risk_of_failing_of_turtles_on_patches</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span></span>
<span>      .cols <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      .fns <span class="op">=</span> <span class="va">as.numeric</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    decision_time_horizon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">decision_time_horizon</span>, ordered <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span></span>
<span>    mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">mean_risk_of_failing_of_turtles_on_patches</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    .by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"step"</span>, <span class="st">"decision_time_horizon"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["step"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["decision_time_horizon"],"name":[2],"type":["ord"],"align":["right"]},{"label":["mean"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"0","2":"1","3":"0.04759662061"},{"1":"1","2":"1","3":"0.04846525757"},{"1":"2","2":"1","3":"0.04678378199"},{"1":"3","2":"1","3":"0.04565313648"},{"1":"4","2":"1","3":"0.04472275559"},{"1":"5","2":"1","3":"0.04191042588"},{"1":"6","2":"1","3":"0.04302576579"},{"1":"7","2":"1","3":"0.04313496542"},{"1":"8","2":"1","3":"0.04086076109"},{"1":"9","2":"1","3":"0.03972318583"},{"1":"10","2":"1","3":"0.03806221575"},{"1":"11","2":"1","3":"0.03538072236"},{"1":"12","2":"1","3":"0.03509107077"},{"1":"13","2":"1","3":"0.03518156007"},{"1":"14","2":"1","3":"0.03452109253"},{"1":"15","2":"1","3":"0.03242868992"},{"1":"16","2":"1","3":"0.03242143281"},{"1":"17","2":"1","3":"0.03147610871"},{"1":"18","2":"1","3":"0.03072766274"},{"1":"19","2":"1","3":"0.02960923264"},{"1":"20","2":"1","3":"0.02904649805"},{"1":"21","2":"1","3":"0.02837021475"},{"1":"22","2":"1","3":"0.02922845240"},{"1":"23","2":"1","3":"0.02931422826"},{"1":"24","2":"1","3":"0.02936138018"},{"1":"25","2":"1","3":"0.02811619096"},{"1":"26","2":"1","3":"0.02818169389"},{"1":"27","2":"1","3":"0.02814241508"},{"1":"28","2":"1","3":"0.02855771239"},{"1":"29","2":"1","3":"0.02797605719"},{"1":"30","2":"1","3":"0.02912655287"},{"1":"31","2":"1","3":"0.02854801404"},{"1":"32","2":"1","3":"0.02782676652"},{"1":"33","2":"1","3":"0.02930315533"},{"1":"34","2":"1","3":"0.02787915854"},{"1":"35","2":"1","3":"0.02815164126"},{"1":"36","2":"1","3":"0.02695227596"},{"1":"37","2":"1","3":"0.02723908516"},{"1":"38","2":"1","3":"0.02676847714"},{"1":"39","2":"1","3":"0.02685775801"},{"1":"40","2":"1","3":"0.02681448725"},{"1":"41","2":"1","3":"0.02565597664"},{"1":"42","2":"1","3":"0.02645466838"},{"1":"43","2":"1","3":"0.02718758136"},{"1":"44","2":"1","3":"0.02634141230"},{"1":"45","2":"1","3":"0.02621424378"},{"1":"46","2":"1","3":"0.02593141350"},{"1":"47","2":"1","3":"0.02608882649"},{"1":"48","2":"1","3":"0.02522539243"},{"1":"49","2":"1","3":"0.02568454706"},{"1":"50","2":"1","3":"0.02580209416"},{"1":"0","2":"5","3":"0.05113442393"},{"1":"1","2":"5","3":"0.04481829758"},{"1":"2","2":"5","3":"0.04019165328"},{"1":"3","2":"5","3":"0.03909971430"},{"1":"4","2":"5","3":"0.03892322133"},{"1":"5","2":"5","3":"0.03805287270"},{"1":"6","2":"5","3":"0.03795962571"},{"1":"7","2":"5","3":"0.03657619448"},{"1":"8","2":"5","3":"0.03451976306"},{"1":"9","2":"5","3":"0.03319883053"},{"1":"10","2":"5","3":"0.03091862637"},{"1":"11","2":"5","3":"0.02942121542"},{"1":"12","2":"5","3":"0.02945045368"},{"1":"13","2":"5","3":"0.02839460692"},{"1":"14","2":"5","3":"0.02797783495"},{"1":"15","2":"5","3":"0.02765125154"},{"1":"16","2":"5","3":"0.02631940161"},{"1":"17","2":"5","3":"0.02506960552"},{"1":"18","2":"5","3":"0.02465192413"},{"1":"19","2":"5","3":"0.02522415948"},{"1":"20","2":"5","3":"0.02468093804"},{"1":"21","2":"5","3":"0.02435260610"},{"1":"22","2":"5","3":"0.02355937297"},{"1":"23","2":"5","3":"0.02296426404"},{"1":"24","2":"5","3":"0.02238793770"},{"1":"25","2":"5","3":"0.02265022285"},{"1":"26","2":"5","3":"0.02214460502"},{"1":"27","2":"5","3":"0.02296256619"},{"1":"28","2":"5","3":"0.02194770219"},{"1":"29","2":"5","3":"0.02208648034"},{"1":"30","2":"5","3":"0.02193006554"},{"1":"31","2":"5","3":"0.02254213877"},{"1":"32","2":"5","3":"0.02227736580"},{"1":"33","2":"5","3":"0.02275051935"},{"1":"34","2":"5","3":"0.02288543242"},{"1":"35","2":"5","3":"0.02225927453"},{"1":"36","2":"5","3":"0.02293020398"},{"1":"37","2":"5","3":"0.02358588368"},{"1":"38","2":"5","3":"0.02401641384"},{"1":"39","2":"5","3":"0.02370982870"},{"1":"40","2":"5","3":"0.02322343922"},{"1":"41","2":"5","3":"0.02334574885"},{"1":"42","2":"5","3":"0.02371621950"},{"1":"43","2":"5","3":"0.02510510126"},{"1":"44","2":"5","3":"0.02323077002"},{"1":"45","2":"5","3":"0.02297166684"},{"1":"46","2":"5","3":"0.02300937420"},{"1":"47","2":"5","3":"0.02214594605"},{"1":"48","2":"5","3":"0.02171252316"},{"1":"49","2":"5","3":"0.02271030682"},{"1":"50","2":"5","3":"0.02233071960"},{"1":"0","2":"25","3":"0.05124502721"},{"1":"1","2":"25","3":"0.02791789138"},{"1":"2","2":"25","3":"0.02572479147"},{"1":"3","2":"25","3":"0.02452635746"},{"1":"4","2":"25","3":"0.02332864237"},{"1":"5","2":"25","3":"0.02280923214"},{"1":"6","2":"25","3":"0.02205894528"},{"1":"7","2":"25","3":"0.02228586298"},{"1":"8","2":"25","3":"0.02203466072"},{"1":"9","2":"25","3":"0.02239321856"},{"1":"10","2":"25","3":"0.02154165910"},{"1":"11","2":"25","3":"0.02101978056"},{"1":"12","2":"25","3":"0.02035293654"},{"1":"13","2":"25","3":"0.02057082312"},{"1":"14","2":"25","3":"0.01916317672"},{"1":"15","2":"25","3":"0.01973621500"},{"1":"16","2":"25","3":"0.01905487644"},{"1":"17","2":"25","3":"0.01874219438"},{"1":"18","2":"25","3":"0.01902150070"},{"1":"19","2":"25","3":"0.01907190866"},{"1":"20","2":"25","3":"0.01909040044"},{"1":"21","2":"25","3":"0.01928537950"},{"1":"22","2":"25","3":"0.01920731090"},{"1":"23","2":"25","3":"0.01952713174"},{"1":"24","2":"25","3":"0.01889277013"},{"1":"25","2":"25","3":"0.01851087953"},{"1":"26","2":"25","3":"0.01869425106"},{"1":"27","2":"25","3":"0.01799065419"},{"1":"28","2":"25","3":"0.01867887614"},{"1":"29","2":"25","3":"0.01852644590"},{"1":"30","2":"25","3":"0.01802511584"},{"1":"31","2":"25","3":"0.01873383049"},{"1":"32","2":"25","3":"0.01885634690"},{"1":"33","2":"25","3":"0.01884665343"},{"1":"34","2":"25","3":"0.01881092243"},{"1":"35","2":"25","3":"0.01920300771"},{"1":"36","2":"25","3":"0.01927319463"},{"1":"37","2":"25","3":"0.01876032255"},{"1":"38","2":"25","3":"0.01832529302"},{"1":"39","2":"25","3":"0.01858300915"},{"1":"40","2":"25","3":"0.01871983738"},{"1":"41","2":"25","3":"0.01858112615"},{"1":"42","2":"25","3":"0.01873653863"},{"1":"43","2":"25","3":"0.01890947164"},{"1":"44","2":"25","3":"0.01911358742"},{"1":"45","2":"25","3":"0.01837733241"},{"1":"46","2":"25","3":"0.01863179039"},{"1":"47","2":"25","3":"0.01888729270"},{"1":"48","2":"25","3":"0.01896713268"},{"1":"49","2":"25","3":"0.01773560442"},{"1":"50","2":"25","3":"0.01804255194"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">step</span>,</span>
<span>      y <span class="op">=</span> <span class="va">mean</span>,</span>
<span>      color <span class="op">=</span> <span class="va">decision_time_horizon</span></span>
<span>      <span class="co"># linetype = decision_time_horizon</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">50</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.06</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Time step (years)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Mean annual risk"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"Time horizon (years)"</span></span>
<span>    <span class="co"># linetype = "Time horizon (years)"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">brandr</span><span class="fu">::</span><span class="fu"><a href="https://danielvartan.github.io/brandr/reference/scale_brand.html">scale_color_brand_d</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="index_files/figure-html/unnamed-chunk-22-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="index_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section></section><section id="license" class="level2"><h2 class="anchored" data-anchor-id="license">License</h2>
<div style="text-align: left;">
<p><a href="http://creativecommons.org/publicdomain/zero/1.0/"><img src="https://img.shields.io/badge/License-CC0_1.0-lightgrey.svg" class="img-fluid"></a></p>
</div>
<p>This report is licensed under <a href="https://creativecommons.org/publicdomain/zero/1.0/">CC0 1.0 Universal</a>, placing it in the public domain. You may freely copy, modify, distribute, and use this work, even for commercial purposes, without permission or attribution.</p>
</section><section id="references" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="references">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-railsback2019a" class="csl-entry" role="listitem">
Railsback, S. F., &amp; Grimm, V. (2019). <em>Agent-based and individual-based modeling: A practical introduction</em> (2nd ed.). Princeton University Press.
</div>
</div>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/danielvartan\.github\.io\/business-investor-model\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/danielvartan/business-investor-model/edit/main/index.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/danielvartan/business-investor-model/blob/main/index.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li><li><a href="https://github.com/danielvartan/business-investor-model/issues/" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer><script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>


</body></html>